---
title: Relación entre Producto Interno Bruto, Esperanza de Vida y Cantidad de Hijos
  por Mujer
author: "Rosalia Carballo Chaves"
date: "2025-08-13"
output:
  beamer_presentation: default
  ioslides_presentation: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
```


```{r}
library(tidyverse)
library(readxl)
library(readr)
library(dplyr)
library(ggplot2)
library(ggrepel)
library(countrycode)
library(scales)
library(maps)
library(DT)
library(lorem)
library(png)
library(grid)
library(tinytex)
library(corrplot)

```


## Introducción
  
Al revisar las bases de datos disponibles en Gapminder, encontré una gran variedad de información relacionada con las mujeres, lo que despertó en mí una inquietud sobre la posible relación entre la longevidad femenina y la maternidad.

Estudios que llamaron mi atención: 

- Vaupel (2001) plantea que podría
existir una relación positiva entre el número de hijos y la longevidad en las mujeres, especialmente cuando el último parto ocurre a una edad avanzada.

- Zhang et al. (2023) afirman que las mujeres que tienen entre tres y cinco hijos tienden a vivir más tiempo, mientras que aquellas con uno o ningún hijo presentan una esperanza de vida más corta.

- Ziepple, Reeve y Peniston (2024) concluyen que la conexión entre la supervivencia materna y la aptitud reproductiva —entendida como el éxito de la descendencia— puede favorecer vidas más largas con menor frecuencia reproductiva.


## Objetivo General

Analizar la relación entre la esperanza de vida femenina, la fecundidad y el nivel de desarrollo económico en países del mundo, utilizando datos históricos de Gapminder entre 1950 y 2021

**Objetivos específicos son**

1.	Comparar la esperanza de vida femenina, la fecundidad y el producto interno bruto per cápita entre regiones geográficas y a lo largo del tiempo.

2.	Explorar combinaciones bivariadas entre esperanza de vida femenina, fecundidad y PIB per cápita.

3.  Evaluar la relación conjunta entre PIB per cápita, fecundidad y esperanza de vida femenina.

4.  Diseñar y presentar un dashboard interactivo que visualice los hallazgos derivados del análisis de las tres variables.

## Metodología de investigación

Esta investigación se basa en un enfoque exploratorio utilizando información agregada a nivel país, lo que permite analizar datos históricos sobre fecundidad, esperanza de vida y producto interno bruto per cápita. Es importante aclarar que, debido a la naturaleza agregada de los datos, no es posible establecer relaciones causales individuales. Lo que se observa son asociaciones a nivel macro, que pueden orientar futuras investigaciones más específicas.

**Datos**

•	Life_expectancy_female: esperanza de vida al nacer de mujeres (en años).

•	Children_per_women_total_fertility: número promedio de hijos por mujer a lo largo de su vida.

•	Gross domestic product per person: producto interno bruto per cápita ajustado por paridad de poder adquisitivo al año 2021.

Gapminder

```{r}
Datos_FEGDP <- readr::read_csv("../Datos/Base_Datos_depurada/base_completa.csv", locale = locale(encoding = "UTF-8"))
Vars <- paste0(c("esperanza_de_vida", "producto_por_capita", "nacimientos_por_mujer", "continente", "gdp_grupo")) 

```

## Preparación de los Datos

Se utilizó el lenguaje de programación R, dada su capacidad para realizar análisis estadísticos, visualizaciones y transformaciones de datos de forma eficiente

Durante la depuración de los datos se identificaron outliers 

•	1175 valores atípicos en la variable de esperanza de vida.

•	765 valores atípicos en la variable de fecundidad.

Se realizaron transformaciones adicionales para corregir errores en nombres de países y se generaron nuevas variables categóricas, como continente y nivel de GDP (alto/bajo)

## Librerías de R

- tidyverse   
- readxl
- readr       
- dplyr
- ggplot2     
- ggrepel
- countrycode 
- scales
- maps        
- DT
- lorem       
- png
- grid        
- tinytex

## Visualización

Se emplearon diversos tipos de gráficos para explorar las relaciones entre variables

  1.	Boxplot 
  
  2.	Gráfico de dispersión
  
  3.	Mapa de calor
  
  4.	Histograma


## Resultados Generales

A partir de las investigaciones presentadas en la introducción, surge la pregunta central ¿Tener menos hijos realmente alarga la esperanza de vida femenina, o tener entre dos y cinco hijos genera un efecto similar?

Muestra una tendencia general decreciente: a mayor número de hijos por mujer, menor esperanza de vida. 

```{r grafico_vida_fecundidad, echo=FALSE, fig.width=6, fig.height=3}

datos_filtrados <- Datos_FEGDP
  
ggplot(datos_filtrados, aes(x = nacimientos_por_mujer, y = esperanza_de_vida)) +
  geom_point(alpha = 0.4, color = "darkred") +
  geom_smooth(method = "lm", se = FALSE, color = "black") +
  labs(title = "Relación entre hijos por mujer 
       y esperanza de vida", x = "Hijos por mujer", y = "Esperanza de vida") +
  theme_minimal()
```

## Algunas excepciones 

Algunos países con tasas de fecundidad de 1 o 2 hijos mantienen niveles altos de esperanza de vida, lo que indica que no puede afirmarse categóricamente que tener menos hijos siempre incrementa la longevidad.

```{r fig.width=6, fig.height=3}
 hijos <- 1.5
  
  # Filtrar datos según 2 hijos
  datos_filtrados <- Datos_FEGDP %>%
    filter(!is.na(nacimientos_por_mujer),
      !is.na(esperanza_de_vida)
    ) %>%
    filter(abs(nacimientos_por_mujer - hijos) < 0.2)

#Gráfico
 ggplot(Datos_FEGDP, aes(x = nacimientos_por_mujer, y = esperanza_de_vida)) +
    geom_point(alpha = 0.3, color = "gray") +
    geom_point(data = datos_filtrados, aes(x = nacimientos_por_mujer, y = esperanza_de_vida), 
               color = "red", size = 3) +
    geom_smooth(method = "loess", se = FALSE, color = "black") +
    labs(
      title = paste("Esperanza de vida según hijos por mujer",
                    if (!is.na(hijos)) paste0("~", hijos) else ""),
      x = "Hijos por mujer",
      y = "Esperanza de vida (años)"
    ) +
    theme_minimal()
```









```{r}

# Filtrar datos si deseas hacerlo por año específico (opcional)
datos_filtrados <- Datos_FEGDP %>% filter(year == 2000)

# Seleccionar solo las variables numéricas de interés
variables <- datos_filtrados %>%
  select(esperanza_de_vida, producto_por_capita, nacimientos_por_mujer)
# Correlación de Pearson
cor_pearson <- cor(variables, method = "pearson", use = "complete.obs")

# Correlación de Spearman
cor_spearman <- cor(variables, method = "spearman", use = "complete.obs")

# Mostrar resultados
print("Correlación de Pearson:")
print(round(cor_pearson, 3))

print("Correlación de Spearman:")
print(round(cor_spearman, 3))

```


## Pruebas Pearson 

Se realiza una prueba de correlación de Pearson para identificar correlaciones positivas como negativas.


```{r fig.width=7, fig.height=4}

# Visualizar matriz de Pearson
corrplot(cor_pearson, method = "circle", type = "upper", tl.cex = 0.8, title = "Pearson")
```

## Pruebas Spearman 
Se realiza una prueba de correlación de Spearman para identificar correlaciones positivas como negativas.


```{r fig.width=7, fig.height=4}
# Visualizar matriz de Spearman
corrplot(cor_spearman, method = "circle", type = "upper", tl.cex = 0.8, title = "Spearman")
```


## A nivel Regional: Europa
 Se observa una caída en la cantidad de hijos por mujeres y con esto también el aumento de la esperanza de vida en países con 2 hijos por mujer. 
 De hecho, varios países con solo 1 hijo muestran menor esperanza de vida que aquellos con 2, lo cual podría deberse a factores contextuales como el envejecimiento poblacional o las políticas de salud.

```{r fig.width=6, fig.height=3}
datos_filtrados <- Datos_FEGDP %>%
  filter(continente == "Europe")
  
ggplot(datos_filtrados, aes(x = nacimientos_por_mujer, y = esperanza_de_vida)) +
  geom_point(alpha = 0.4, color = "darkred") +
  geom_smooth(method = "lm", se = FALSE, color = "black") +
  labs(title = "Relación entre hijos por mujer 
       y esperanza de vida de Europa", x = "Hijos por mujer", y = "Esperanza de vida") +
  theme_minimal()
```

## A nivel Regional: África
Se registra la esperanza de vida más baja en comparación con otros continentes, manteniéndose la tendencia decreciente a pesar de una alta fecundidad.

```{r fig.width=8, fig.height=4}
ggplot(Datos_FEGDP, aes(x = continente, y = esperanza_de_vida)) +
  geom_boxplot(fill = "green") +
  labs(title = "Esperanza de vida por continente", y = "Esperanza de vida", x = "Continente") +
  theme_minimal()

```

## A nivel Regional: África
En esta región, el bajo nivel del PIB per cápita también resalta como un elemento que podría influir en los resultados, reflejando bajos niveles de desarrollo económico.

```{r fig.width=8, fig.height=4}
ggplot(Datos_FEGDP, aes(x = continente, y = producto_por_capita)) +
  geom_boxplot(fill = "blue") +
  labs(title = "Producto Interno Bruto por continente", y = "GDP", x = "Continente") +
  theme_minimal()
```


## A nivel Regional: Áméricas
Se conserva la tendencia general: los países con mayor fecundidad tienden a registrar niveles más bajos de esperanza de vida. Este patrón refuerza la hipótesis de una correlación negativa entre estas dos variables, aunque no necesariamente causal.

```{r fig.width=7, fig.height=3}
datos_filtrados <- Datos_FEGDP %>%
  filter(continente == "Americas")
  
ggplot(datos_filtrados, aes(x = nacimientos_por_mujer, y = esperanza_de_vida)) +
  geom_point(alpha = 0.4, color = "darkred") +
  geom_smooth(method = "lm", se = FALSE, color = "black") +
  labs(title = "Relación entre hijos por mujer 
       y esperanza de vida de America", x = "Hijos por mujer", y = "Esperanza de vida") +
  theme_minimal()
```

## Interacción Avanzada: GDP, esperanza de vida y cantidad de hijos
Se identifican valores altos de esperanza de vida asociados a tasas de fecundidad cercanas a 0.7 hijos por mujer, con una esperanza de vida promedio entre 86 y 89 años.

```{r fig.width=6, fig.height=3}
vida_min <- 86
vida_max <- 89
  
  # Filtrar datos según los inputs
  datos_filtrados <- Datos_FEGDP %>%
    filter(!is.na(nacimientos_por_mujer),
      !is.na(esperanza_de_vida)
    ) %>%
    filter(esperanza_de_vida >= vida_min & esperanza_de_vida <= vida_max)

#Gráfico
 ggplot(Datos_FEGDP, aes(x = esperanza_de_vida, y = nacimientos_por_mujer)) +
    geom_point(alpha = 0.3, color = "pink") +
    geom_point(data = datos_filtrados, aes(x = esperanza_de_vida, y = nacimientos_por_mujer), 
               color = "blue", size = 3) +
    geom_smooth(method = "loess", se = FALSE, color = "black") +
    labs(
      title = paste("Hijos por mujer según esperanza de vida",
                    vida_min, "y", vida_max, "años"),
      x = "Esperanza de vida (años)",
      y = "Hijos por mujer"
    ) +
    theme_minimal()
```

## Interacción Avanzada: GDP, esperanza de vida y cantidad de hijos
Los países con una fecundidad de 1 hijo muestran una esperanza de vida aún mayor, entre 93 y 96 años. No puede afirmarse que a menor número de hijos por mujer siempre corresponda una mayor esperanza de vida.

```{r fig.width=6, fig.height=3}
vida_min1 <- 93
vida_max2 <- 96
  
  # Filtrar datos según los inputs
  datos_filtrados <- Datos_FEGDP %>%
    filter(!is.na(nacimientos_por_mujer),
      !is.na(esperanza_de_vida)
    ) %>%
    filter(esperanza_de_vida >= vida_min1 & esperanza_de_vida <= vida_max2)

#Gráfico
 ggplot(Datos_FEGDP, aes(x = esperanza_de_vida, y = nacimientos_por_mujer)) +
    geom_point(alpha = 0.3, color = "pink") +
    geom_point(data = datos_filtrados, aes(x = esperanza_de_vida, y = nacimientos_por_mujer), 
               color = "blue", size = 3) +
    geom_smooth(method = "loess", se = FALSE, color = "black") +
    labs(
      title = paste("Hijos por mujer según esperanza de vida",
                    vida_min1, "y", vida_max2, "años"),
      x = "Esperanza de vida (años)",
      y = "Hijos por mujer"
    ) +
    theme_minimal()
```


## Producto Interno Bruto
Aquellos paises con mayor PIB per cápita, la relación entre baja fecundidad y alta esperanza de vida es más clara y estable. 

```{r fig.width=8, fig.height=5}
  datos_filtrados <- Datos_FEGDP %>%
    filter(
      !is.na(producto_por_capita), 
      !is.na(nacimientos_por_mujer), 
      !is.na(esperanza_de_vida)
)

# Gráfico
ggplot(datos_filtrados, aes(x = producto_por_capita, 
                            y = nacimientos_por_mujer, 
                            size = esperanza_de_vida, 
                            color = esperanza_de_vida)) +
  geom_point(alpha = 0.8) +
  scale_x_log10(labels = dollar_format(prefix = "$")) +
  scale_color_gradient(low = "red", high = "blue") +
  labs(title = "Relación entre GDP, fecundidad y esperanza de vida",
       x = "Producto Interno Bruto per cápita (log)",
       y = "Hijos por mujer",
       color = "Esperanza de vida (años)",
       size = "Esperanza de vida") +
  theme_minimal()+
  theme(
    plot.title = element_text(size = 15, face = "bold"),
    axis.title = element_text(size = 10)
  )
```


## Eje Temporal: 1970
En el gráfico "Relación entre GDP, fecundidad y esperanza de vida", se aprecia que en 1970 la esperanza de vida promedio mundial rondaba los 80 años. 


```{r fig.width=7, fig.height=4}
  datos_filtrados <- Datos_FEGDP %>%
    filter( year == 1970,
      !is.na(producto_por_capita), 
      !is.na(nacimientos_por_mujer), 
      !is.na(esperanza_de_vida)
)

# Gráfico
ggplot(datos_filtrados, aes(x = producto_por_capita, 
                            y = nacimientos_por_mujer, 
                            size = esperanza_de_vida, 
                            color = esperanza_de_vida)) +
  geom_point(alpha = 0.8) +
  scale_x_log10(labels = dollar_format(prefix = "$")) +
  scale_color_gradient(low = "red", high = "blue") +
  labs(title = "Relación entre GDP, fecundidad y esperanza de vida en 1970",
       x = "Producto Interno Bruto per cápita (log)",
       y = "Hijos por mujer",
       color = "Esperanza de vida (años)",
       size = "Esperanza de vida") +
  theme_minimal()+
  theme(
    plot.title = element_text(size = 15, face = "bold"),
    axis.title = element_text(size = 10)
  )
```

## Eje Temporal: 2020
Esta cifra aumentó casi en una década, acercándose a los 90 años. Este incremento evidencia mejoras globales en salud, condiciones de vida y acceso a servicios básicos.

```{r fig.width=8, fig.height=4}
  datos_filtrados <- Datos_FEGDP %>%
    filter( year == 2000,
      !is.na(producto_por_capita), 
      !is.na(nacimientos_por_mujer), 
      !is.na(esperanza_de_vida)
)

# Gráfico
ggplot(datos_filtrados, aes(x = producto_por_capita, 
                            y = nacimientos_por_mujer, 
                            size = esperanza_de_vida, 
                            color = esperanza_de_vida)) +
  geom_point(alpha = 0.8) +
  scale_x_log10(labels = dollar_format(prefix = "$")) +
  scale_color_gradient(low = "red", high = "blue") +
  labs(title = "Relación entre GDP, fecundidad y esperanza de vida en 2000",
       x = "Producto Interno Bruto per cápita (log)",
       y = "Hijos por mujer",
       color = "Esperanza de vida (años)",
       size = "Esperanza de vida") +
  theme_minimal()+
  theme(
    plot.title = element_text(size = 15, face = "bold"),
    axis.title = element_text(size = 10)
  )
```

## Ideas Finales

Aunque la fecundidad no constituye un determinante único en la decisión de tener hijos ni en la esperanza de vida, sí representa un componente clave en el análisis con perspectiva de género.

Las decisiones reproductivas están profundamente influenciadas por factores sociales, económicos y culturales, que varían según el contexto y el nivel de desarrollo.

Además, existen otras perspectivas que no pudieron abordarse en esta investigación debido a la falta de información disponible, como el rol del compañero o compañera de crianza, así como la presencia de redes de apoyo familiares, comunitarias o institucionales. 

## Ideas Finales

En este estudio, la regresión múltiple revela que el PIB per cápita y la fecundidad explican conjuntamente más del 84% de la variabilidad en la esperanza de vida femenina. Este resultado evidencia una correlación multivariable sólida entre desarrollo económico, salud y dinámica demográfica, y refuerza la necesidad de abordar los indicadores poblacionales desde una mirada integrada y contextualizada.

Se alinean con estudios previos que sugieren un vínculo entre decisiones reproductivas y longevidad femenina. Si bien no se puede establecer una relación causal directa, los datos apuntan a que niveles moderados de fecundidad —como tener un solo hijo— podrían asociarse con una mayor esperanza de vida, especialmente en contextos con mejores condiciones socioeconómicas.



## Construcción del Dashboard

En la primera sección del dashboard, el objetivo era ofrecer una visión general de las tres variables principales. 

La segunda sección, dedicada a los gráficos comparativos de variables, presenta tres gráficos de dispersión con distintos colores, lo que facilita su diferenciación. 

En la tercera sección, correspondiente a los gráficos de interacción avanzada, se representa la relación entre las tres variables mediante un gráfico de dispersión.

## Bibliografía

1.	Bobbi S. Low, Ashley Hazel, Nicholas Parker and Kathleen B. Welch (2008) Influences on Women's Reproductive Lives : Unexpected Ecological, Cross-Cultural Research 42: 201. http://ccr.sagepub.com/content/42/3/201
2.	Gapminder. (s.f.). Gapminder data. Gapminder Foundation. https://www.gapminder.org/data/
3.	Hampton, J. (2021). Does very high human development lead to fertility rebound? An analysis of the Human Life Indicator. Demographic Research, 44, 121–156. https://doi.org/10.4054/DemRes.2021.44.5
4.	OpenAI. (2025). ChatGPT (versión GPT-4o) [modelo de lenguaje]. https://chat.openai.com/
5.	Rees, P. (2001). Children and long life: A tale of two hypotheses. People and Place, 9(2), 14–17. https://doi.org/10.3316/ielapa.200110709

## Bibliografía

6.	Vaupel, J. W., Carey, J. R., & Christensen, K. (2001). Longevity and aging: Controversial issues in demography. International Journal of Epidemiology, 30(4), 628–631. https://doi.org/10.1093/ije/30.4.628
7.	Zhang, C., Cao, J., Yang, Q., & Wu, Y. (2023). Association between number of children and female longevity: Evidence from the Chinese Longitudinal ealthy Longevity Survey. Authorea. https://doi.org/10.22541/au.169765027.7634832
8.  Zipple, M. N., Reeve, H. K., & Peniston, O. J. (2024). Maternal care leads to the evolution of long, slow lives. Proceedings of the National Academy of Sciences, 121(25), e2403491121. https://doi.org/10.1073/pnas.2403491121
